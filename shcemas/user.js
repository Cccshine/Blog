const mongoose = require('mongoose');

const UserSchema = new mongoose.Schema({
	name:{
		unique:true,
		type:String
	},
	password:String,
	//角色：0--普通用户 1--管理员
	role:{
		type:Number,
		default:0
	},
	email:String,
	avatar:{
		type:String,
		default:'data:image/jpeg;base64,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'
	},
	meta:{
		createTime:{
			type:Date,
			default:Date.now()
		},
		updateTime:{
			type:Date,
			default:Date.now()
		}
	}
});

//保存前执行的函数
UserSchema.pre('save',function(next){
	let user = this;//this指之后要保存的user实例
	if(user.isNew){
		user.meta.createTime = user.meta.updateTime = Date.now();
	}else{
		user.meta.updateTime = Date.now();
	}
	next();
})

module.exports = UserSchema;